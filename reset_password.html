<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Reset Password â€” WhiteBox Agency</title>
  <link rel="stylesheet" href="css/whitebox.css">
  <style>
    body{font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; background:#fff; color:#111827;}
    .container{max-width:640px; margin:0 auto; padding:20px;}
    .card{border:1px solid #e5e7eb; border-radius:16px; padding:16px;}
    input{width:100%; padding:12px; border-radius:12px; border:1px solid #d1d5db; font-size:14px;}
    .btn{display:inline-flex; align-items:center; justify-content:center; padding:10px 14px; border-radius:10px; border:1px solid rgba(0,0,0,0.12); text-decoration:none; color:#111827; background:#fff; cursor:pointer;}
    .btn-primary{background:#111827;color:#fff;border-color:#111827;}
    .msg{margin-top:10px; padding:10px 12px; border-radius:12px; font-size:14px;}
    .ok{background:#ecfdf5; border:1px solid #a7f3d0; color:#065f46;}
    .err{background:#fef2f2; border:1px solid #fecaca; color:#991b1b;}
  </style>
</head>
<body>
  <div class="container">
    <h1>Reset your password</h1>
    <p>Enter a new password below.</p>

    <div class="card">
      <label for="pw" style="font-weight:700;">New password</label>
      <input id="pw" type="password" placeholder="New password">
      <div style="height:10px;"></div>
      <label for="pw2" style="font-weight:700;">Confirm new password</label>
      <input id="pw2" type="password" placeholder="Confirm new password">
      <div style="height:14px;"></div>
      <button class="btn btn-primary" id="save">Save password</button>
      <div id="msg"></div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>


  <script src="js/supabase-config.js"></script>
  <script src="js/supabase-client.js"></script>
  <script>
    const msg = document.getElementById("msg");
    function show(text, ok){
      msg.innerHTML = '<div class="msg '+(ok?'ok':'err')+'">'+text+'</div>';
    }
    document.getElementById("save").addEventListener("click", async () => {
      const pw = document.getElementById("pw").value;
      const pw2 = document.getElementById("pw2").value;
      if (!pw || pw.length < 8) return show("Use at least 8 characters.", false);
      if (pw !== pw2) return show("Passwords do not match.", false);

      const supabase = window.getSupabaseClient();
      const { error } = await supabase.auth.updateUser({ password: pw });
      if (error) return show(error.message, false);
      show("Password updated. You can now log in.", true);
      setTimeout(() => { window.location.href = "login.html"; }, 1200);
    });
  </script>
</body>
</html>
